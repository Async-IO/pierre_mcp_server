# Pierre MCP Server - Development Environment
# Copy this to .envrc for local development settings

# Default Provider Configuration
# Set to "strava" for real OAuth testing, "synthetic" for development without OAuth
export PIERRE_DEFAULT_PROVIDER=strava

# OAuth Provider Configuration (optional - can be set per-tenant via admin API)
export STRAVA_CLIENT_ID=your-strava-client-id
export STRAVA_CLIENT_SECRET=your-strava-client-secret
export STRAVA_REDIRECT_URI=http://localhost:8080/api/oauth/callback/strava

# Garmin Connect OAuth Configuration
export GARMIN_CLIENT_ID=your-garmin-consumer-key
export GARMIN_CLIENT_SECRET=your-garmin-consumer-secret
export GARMIN_REDIRECT_URI=http://localhost:8080/api/oauth/callback/garmin

# Bridge OAuth Callback Configuration
# After provider OAuth completes, server redirects to bridge callback server to trigger focus recovery
export OAUTH_CALLBACK_PORT=35535

# Weather Service Configuration
export OPENWEATHER_API_KEY="your-openweathermap-api-key"

# Server Configuration - Unified Single Port Architecture
export HTTP_PORT="8080"
export RUST_LOG="info"

# Database Configuration
export DATABASE_URL="sqlite:./data/users.db"
# For PostgreSQL: export DATABASE_URL="postgresql://user:pass@localhost/pierre_db"
export JWT_EXPIRY_HOURS="24"

# PostgreSQL Connection Pool Configuration (when using PostgreSQL)
# These values are automatically optimized for CI vs production environments
export POSTGRES_MAX_CONNECTIONS="10"     # Default: 10 (prod), 5 (CI)
export POSTGRES_MIN_CONNECTIONS="0"      # Default: 0 (prod), 1 (CI)
export POSTGRES_ACQUIRE_TIMEOUT="30"     # Default: 30 (prod), 30 (CI)

# Master Encryption Key for persistent two-tier key management
# Generate with: openssl rand -base64 32
export PIERRE_MASTER_ENCRYPTION_KEY="your-base64-encoded-master-key"

# RSA Key Size for JWT signing (RS256)
# Production: 4096 (higher security, slower ~10s key generation)
# Testing: 2048 (faster ~250ms key generation, sufficient for dev/test)
export PIERRE_RSA_KEY_SIZE="2048"  # Use 4096 for production

# Rate Limiting Configuration
export RATE_LIMIT_ENABLED="true"
export RATE_LIMIT_REQUESTS="100"
export RATE_LIMIT_WINDOW="60"

# Backup Configuration
export BACKUP_ENABLED="true"
export BACKUP_INTERVAL="21600"  # 6 hours in seconds
export BACKUP_RETENTION="7"
export BACKUP_DIRECTORY="./backups"

# Activity Fetch Limits
export MAX_ACTIVITIES_FETCH="100"
export DEFAULT_ACTIVITIES_LIMIT="20"

# ============================================================================
# FITNESS CONFIGURATION - Environment-Only (Cloud-Native Approach)
# ============================================================================
# All fitness algorithm parameters are now configured via environment variables
# for easy cloud deployment. No TOML files - single source of truth.

# Fitness Effort Thresholds (1-10 scale for workout intensity classification)
export FITNESS_EFFORT_LIGHT_MAX="3.0"
export FITNESS_EFFORT_MODERATE_MAX="5.0"
export FITNESS_EFFORT_HARD_MAX="7.0"
# > 7.0 = very_high

# Heart Rate Zone Thresholds (percentage of max HR)
export FITNESS_ZONE_RECOVERY_MAX="60.0"
export FITNESS_ZONE_ENDURANCE_MAX="70.0"
export FITNESS_ZONE_TEMPO_MAX="80.0"
export FITNESS_ZONE_THRESHOLD_MAX="90.0"
# > 90.0 = vo2max

# Weather Integration Settings
export FITNESS_WEATHER_WIND_THRESHOLD="15.0"
export FITNESS_WEATHER_ENABLED="true"
export FITNESS_WEATHER_CACHE_DURATION_HOURS="24"
export FITNESS_WEATHER_REQUEST_TIMEOUT_SECONDS="10"
export FITNESS_WEATHER_RATE_LIMIT_PER_MINUTE="60"

# Personal Records Configuration
export FITNESS_PR_PACE_IMPROVEMENT_THRESHOLD="5.0"

# OAuth Login Form Defaults (for dev/test only - leave empty in production)
export OAUTH_DEFAULT_EMAIL="user@example.com"
export OAUTH_DEFAULT_PASSWORD="userpass123"